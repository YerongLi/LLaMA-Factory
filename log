02/12/2024 11:56:10 - WARNING - llmtuner.hparams.parser - `ddp_find_unused_parameters` needs to be set as False for LoRA in DDP training.
02/12/2024 11:56:10 - INFO - llmtuner.hparams.parser - Process rank: 0, device: cuda:0, n_gpu: 1
  distributed training: True, compute dtype: torch.float16
02/12/2024 11:56:10 - INFO - llmtuner.hparams.parser - Training/evaluation parameters Seq2SeqTrainingArguments(
_n_gpu=1,
adafactor=False,
adam_beta1=0.9,
adam_beta2=0.999,
adam_epsilon=1e-08,
auto_find_batch_size=False,
bf16=False,
bf16_full_eval=False,
data_seed=None,
dataloader_drop_last=False,
dataloader_num_workers=0,
dataloader_persistent_workers=False,
dataloader_pin_memory=True,
dataloader_prefetch_factor=None,
ddp_backend=None,
ddp_broadcast_buffers=None,
ddp_bucket_cap_mb=None,
ddp_find_unused_parameters=False,
ddp_timeout=1800,
debug=[],
deepspeed=None,
disable_tqdm=False,
dispatch_batches=None,
do_eval=False,
do_predict=False,
do_train=True,
eval_accumulation_steps=None,
eval_delay=0,
eval_steps=None,
evaluation_strategy=IntervalStrategy.NO,
fp16=True,
fp16_backend=auto,
fp16_full_eval=False,
fp16_opt_level=O1,
fsdp=[],
fsdp_config={'min_num_params': 0, 'xla': False, 'xla_fsdp_grad_ckpt': False},
fsdp_min_num_params=0,
fsdp_transformer_layer_cls_to_wrap=None,
full_determinism=False,
generation_config=None,
generation_max_length=None,
generation_num_beams=None,
gradient_accumulation_steps=4,
gradient_checkpointing=False,
gradient_checkpointing_kwargs=None,
greater_is_better=None,
group_by_length=False,
half_precision_backend=auto,
hub_always_push=False,
hub_model_id=None,
hub_private_repo=False,
hub_strategy=HubStrategy.EVERY_SAVE,
hub_token=<HUB_TOKEN>,
ignore_data_skip=False,
include_inputs_for_metrics=False,
include_num_input_tokens_seen=False,
include_tokens_per_second=False,
jit_mode_eval=False,
label_names=None,
label_smoothing_factor=0.0,
learning_rate=5e-05,
length_column_name=length,
load_best_model_at_end=False,
local_rank=0,
log_level=passive,
log_level_replica=warning,
log_on_each_node=True,
logging_dir=path_to_pt_checkpoint/runs/Feb12_11-56-10_ccc0076.campuscluster.illinois.edu,
logging_first_step=False,
logging_nan_inf_filter=True,
logging_steps=10,
logging_strategy=IntervalStrategy.STEPS,
lr_scheduler_kwargs={},
lr_scheduler_type=SchedulerType.COSINE,
max_grad_norm=1.0,
max_steps=-1,
metric_for_best_model=None,
mp_parameters=,
neftune_noise_alpha=None,
no_cuda=False,
num_train_epochs=3.0,
optim=OptimizerNames.ADAMW_TORCH,
optim_args=None,
output_dir=path_to_pt_checkpoint,
overwrite_output_dir=False,
past_index=-1,
per_device_eval_batch_size=8,
per_device_train_batch_size=4,
predict_with_generate=False,
prediction_loss_only=False,
push_to_hub=False,
push_to_hub_model_id=None,
push_to_hub_organization=None,
push_to_hub_token=<PUSH_TO_HUB_TOKEN>,
ray_scope=last,
remove_unused_columns=True,
report_to=[],
resume_from_checkpoint=None,
run_name=path_to_pt_checkpoint,
save_on_each_node=False,
save_only_model=False,
save_safetensors=True,
save_steps=1000,
save_strategy=IntervalStrategy.STEPS,
save_total_limit=None,
seed=42,
skip_memory_metrics=True,
sortish_sampler=False,
split_batches=False,
tf32=None,
torch_compile=False,
torch_compile_backend=None,
torch_compile_mode=None,
torchdynamo=None,
tpu_metrics_debug=False,
tpu_num_cores=None,
use_cpu=False,
use_ipex=False,
use_legacy_prediction_loop=False,
use_mps_device=False,
warmup_ratio=0.0,
warmup_steps=0,
weight_decay=0.0,
)
02/12/2024 11:56:11 - INFO - llmtuner.model.patcher - Gradient checkpointing enabled.
02/12/2024 11:56:11 - INFO - llmtuner.model.adapter - Fine-tuning method: LoRA
02/12/2024 11:56:12 - INFO - llmtuner.model.loader - trainable params: 4194304 || all params: 6742609920 || trainable%: 0.0622
02/12/2024 11:56:12 - INFO - llmtuner.data.template - Replace eos token: <|end|>
02/12/2024 11:56:12 - WARNING - llmtuner.data.template - New tokens have been added, make sure `resize_vocab` is True.
02/12/2024 11:56:12 - INFO - llmtuner.data.template - Add pad token: <|end|>
02/12/2024 11:56:12 - INFO - llmtuner.data.loader - Loading dataset BelleGroup/generated_chat_0.4M...
input_ids:
[0, 29871, 13, 32000, 29871, 13, 0, 29871, 13, 31359, 30909, 30651, 30557, 31432, 31085, 30689, 31021, 31366, 30494, 30287, 31559, 30783, 31852, 13, 29909, 1357, 30383, 30392, 30287, 30548, 30257, 30415, 30486, 30214, 30783, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30802, 30748, 234, 134, 176, 234, 139, 180, 30214, 31412, 31190, 31125, 30666, 31419, 235, 184, 158, 30214, 233, 142, 168, 30417, 30923, 30502, 31419, 235, 184, 158, 232, 168, 153, 233, 160, 178, 30267, 13, 20841, 30383, 30392, 30287, 30548, 233, 187, 187, 233, 139, 146, 30539, 30931, 30528, 31624, 30214, 235, 183, 162, 235, 183, 166, 31026, 30910, 30503, 30910, 31454, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30214, 30783, 31679, 234, 174, 161, 235, 184, 158, 30745, 30417, 31947, 30752, 30743, 31201, 30267, 13, 32000, 29871, 13, 0, 29871, 13, 29909, 1357, 29901, 29871, 30919, 31076, 30214, 20841, 30214, 30672, 30392, 29909, 1357, 30214, 30287, 30548, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 31333, 30880, 30214, 232, 193, 139, 30528, 31914, 31439, 235, 178, 137, 30919, 30267, 13, 20841, 29901, 29871, 232, 193, 139, 30528, 31914, 235, 170, 132, 30780, 30919, 30214, 29909, 1357, 30267, 232, 147, 175, 31639, 30919, 30505, 31679, 234, 174, 161, 31419, 235, 184, 158, 30275, 30746, 31424, 30544, 31085, 30214, 31024, 31050, 30743, 232, 193, 139, 30923, 232, 168, 153, 233, 160, 178, 30267, 13, 29909, 1357, 29901, 29871, 30392, 30210, 30214, 30672, 31290, 31412, 31125, 30666, 30743, 232, 193, 139, 30923, 31419, 235, 184, 158, 30214, 231, 192, 137, 30392, 30672, 31439, 30573, 233, 187, 187, 233, 139, 146, 31994, 30417, 232, 193, 139, 30257, 30210, 31302, 232, 144, 138, 30816, 31016, 30267, 30919, 30783, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30210, 30910, 31599, 30417, 231, 190, 131, 31882, 31811, 30545, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30672, 31439, 30573, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30210, 31295, 30805, 31838, 31190, 30867, 30592, 30267, 30672, 31381, 30210, 30539, 30931, 30724, 30505, 31026, 30910, 30287, 233, 175, 193, 31838, 31190, 30417, 233, 192, 159, 31074, 30210, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30214, 30847, 30801, 30919, 30417, 31914, 235, 185, 166, 30210, 31852, 30214, 30682, 30651, 30805, 30672, 31381, 30539, 30931, 31787, 234, 145, 172, 30287, 30557, 30267, 13, 29909, 1357, 29901, 29871, 31838, 31190, 233, 135, 162, 235, 179, 165, 30919, 30210, 236, 133, 131, 31088, 30214, 30672, 30287, 30495, 30437, 31475, 31787, 30287, 31787, 30267, 30413, 31138, 30505, 31419, 235, 184, 158, 30275, 30672, 30910, 31424, 30214, 31679, 234, 174, 161, 31333, 30880, 30577, 31016, 30210, 233, 181, 162, 30768, 31838, 31190, 30908, 30698, 30214, 30919, 30539, 30931, 30210, 233, 187, 187, 233, 139, 146, 30275, 30392, 31191, 30417, 30287, 31959, 31398, 31151, 30210, 31429, 31072, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30948, 31516, 30267, 30672, 31381, 30210, 233, 187, 187, 233, 139, 146, 30275, 30417, 30457, 31893, 30413, 30980, 30210, 233, 181, 162, 30768, 30525, 30607, 30267, 31333, 30880, 30682, 30651, 30768, 31138, 30728, 30669, 30210, 31505, 30941, 235, 132, 141, 30408, 30768, 30397, 30330, 30333, 30578, 235, 132, 141, 30408, 31391, 30767, 234, 177, 131, 31166, 30210, 30746, 30993, 31277, 30850, 30805, 31398, 31151, 30267, 13, 29909, 1357, 29901, 29871, 31356, 232, 147, 175, 31558, 30805, 232, 193, 139, 30417, 235, 185, 166, 30267, 31088, 31658, 30919, 30539, 30931, 30895, 30658, 30878, 30257, 30210, 233, 143, 148, 233, 139, 155, 30392, 231, 190, 131, 31882, 30882, 13, 20841, 29901, 29871, 30672, 31381, 31424, 30505, 30878, 30257, 30210, 233, 143, 148, 233, 139, 155, 30392, 31522, 30698, 235, 177, 172, 30672, 30210, 30539, 30931, 30210, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 31100, 30666, 30606, 235, 164, 164, 30214, 235, 177, 172, 31951, 30502, 30313, 30769, 30815, 231, 189, 174, 232, 146, 154, 30780, 233, 187, 187, 233, 139, 146, 30210, 232, 194, 174, 31616, 30214, 31325, 30413, 30392, 31557, 30417, 31356, 31959, 30528, 30880, 30267, 13, 29909, 1357, 29901, 29871, 30810, 31835, 31195, 30392, 232, 193, 139, 30908, 30698, 30210, 30267, 30672, 233, 158, 193, 31412, 30505, 30287, 31959, 31419, 235, 184, 158, 30275, 236, 132, 138, 30780, 30743, 232, 193, 139, 232, 191, 189, 30210, 30783, 30880, 30214, 233, 135, 162, 235, 170, 140, 233, 187, 187, 233, 139, 146, 31369, 31475, 30743, 30287, 31959, 30606, 235, 164, 164, 30214, 30810, 232, 193, 139, 30413, 30539, 30606, 30267, 31658, 31596, 30392, 30214, 30919, 31381, 30847, 31502, 31548, 30687, 30810, 30502, 31658, 31596, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30672, 31381, 30724, 30505, 31026, 30910, 30287, 232, 168, 154, 30374, 30210, 233, 145, 149, 30548, 31185, 31675, 30214, 30998, 31393, 30763, 31951, 30502, 234, 145, 172, 30613, 30210, 31195, 236, 156, 136, 31615, 30815, 235, 178, 135, 30495, 30214, 31594, 31325, 30606, 235, 164, 164, 31951, 30502, 30313, 30210, 234, 145, 172, 30545, 30988, 236, 173, 143, 30267, 13, 29909, 1357, 29901, 29871, 31356, 232, 147, 175, 31558, 30805, 232, 193, 139, 31076, 30267, 31841, 31839, 30672, 30682, 30651, 30494, 30573, 30622, 30287, 30502, 31787, 234, 145, 172, 30810, 30502, 31185, 31675, 30210, 30313, 30267, 235, 179, 165, 235, 179, 165, 30919, 30210, 30594, 31016, 30214, 20841, 30267, 13, 32000]
inputs:
<unk> 
<|end|> 
<unk> 
基于以下角色信息完成一段对话
Amy：是一名大学生，对电竞游戏十分热爱，经常参加比赛，拥有多个比赛奖杯。
Ben：是一名游戏公司高管，负责开发和发布电竞游戏，对电竞赛事有深入了解。
<|end|> 
<unk> 
Amy: 你好，Ben，我是Amy，一名电竞游戏选手，很高兴认识你。
Ben: 很高兴见到你，Amy。听说你在电竞比赛中表现出色，获得了很多奖杯。
Amy: 是的，我已经参加了很多比赛，但是我认为游戏还有很大的提升空间。你对电竞游戏的发展有什么看法呢？
Ben: 我认为电竞游戏的未来非常光明。我们的公司正在开发一款非常有潜力的电竞游戏，如果你有兴趣的话，可以来我们公司试玩一下。
Amy: 非常感谢你的邀请，我一定会去试一试。不过在比赛中我发现，电竞选手之间的沟通非常重要，你公司的游戏中是否有一些交流的机制呢？
Ben: 当然。我们的游戏中有三种不同的沟通方式。选手可以通过内置的语音聊天通道、文字聊天或者简单的表情符号来交流。
Amy: 那听起来很有趣。请问你公司目前最大的挑战是什么？
Ben: 我们现在最大的挑战是想要让我的公司的电竞游戏更加平衡，让每个人都能享受到游戏的快乐，而不是只有那些高手。
Amy: 这确实是很重要的。我曾经在一些比赛中遇到了很强的对手，感觉游戏失去了一些平衡，这很不公平。问题是，你们如何处理这个问题呢？
Ben: 我们正在开发一套新的排名系统，将根据每个玩家的实际技能评定，从而平衡每个人的玩法体验。
Amy: 那听起来很好。希望我可以成为第一个试玩这个系统的人。谢谢你的时间，Ben。
<|end|>
label_ids:
[-100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, -100, 29871, 13, 29909, 1357, 29901, 29871, 30919, 31076, 30214, 20841, 30214, 30672, 30392, 29909, 1357, 30214, 30287, 30548, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 31333, 30880, 30214, 232, 193, 139, 30528, 31914, 31439, 235, 178, 137, 30919, 30267, 13, 20841, 29901, 29871, 232, 193, 139, 30528, 31914, 235, 170, 132, 30780, 30919, 30214, 29909, 1357, 30267, 232, 147, 175, 31639, 30919, 30505, 31679, 234, 174, 161, 31419, 235, 184, 158, 30275, 30746, 31424, 30544, 31085, 30214, 31024, 31050, 30743, 232, 193, 139, 30923, 232, 168, 153, 233, 160, 178, 30267, 13, 29909, 1357, 29901, 29871, 30392, 30210, 30214, 30672, 31290, 31412, 31125, 30666, 30743, 232, 193, 139, 30923, 31419, 235, 184, 158, 30214, 231, 192, 137, 30392, 30672, 31439, 30573, 233, 187, 187, 233, 139, 146, 31994, 30417, 232, 193, 139, 30257, 30210, 31302, 232, 144, 138, 30816, 31016, 30267, 30919, 30783, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30210, 30910, 31599, 30417, 231, 190, 131, 31882, 31811, 30545, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30672, 31439, 30573, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30210, 31295, 30805, 31838, 31190, 30867, 30592, 30267, 30672, 31381, 30210, 30539, 30931, 30724, 30505, 31026, 30910, 30287, 233, 175, 193, 31838, 31190, 30417, 233, 192, 159, 31074, 30210, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 30214, 30847, 30801, 30919, 30417, 31914, 235, 185, 166, 30210, 31852, 30214, 30682, 30651, 30805, 30672, 31381, 30539, 30931, 31787, 234, 145, 172, 30287, 30557, 30267, 13, 29909, 1357, 29901, 29871, 31838, 31190, 233, 135, 162, 235, 179, 165, 30919, 30210, 236, 133, 131, 31088, 30214, 30672, 30287, 30495, 30437, 31475, 31787, 30287, 31787, 30267, 30413, 31138, 30505, 31419, 235, 184, 158, 30275, 30672, 30910, 31424, 30214, 31679, 234, 174, 161, 31333, 30880, 30577, 31016, 30210, 233, 181, 162, 30768, 31838, 31190, 30908, 30698, 30214, 30919, 30539, 30931, 30210, 233, 187, 187, 233, 139, 146, 30275, 30392, 31191, 30417, 30287, 31959, 31398, 31151, 30210, 31429, 31072, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30948, 31516, 30267, 30672, 31381, 30210, 233, 187, 187, 233, 139, 146, 30275, 30417, 30457, 31893, 30413, 30980, 30210, 233, 181, 162, 30768, 30525, 30607, 30267, 31333, 30880, 30682, 30651, 30768, 31138, 30728, 30669, 30210, 31505, 30941, 235, 132, 141, 30408, 30768, 30397, 30330, 30333, 30578, 235, 132, 141, 30408, 31391, 30767, 234, 177, 131, 31166, 30210, 30746, 30993, 31277, 30850, 30805, 31398, 31151, 30267, 13, 29909, 1357, 29901, 29871, 31356, 232, 147, 175, 31558, 30805, 232, 193, 139, 30417, 235, 185, 166, 30267, 31088, 31658, 30919, 30539, 30931, 30895, 30658, 30878, 30257, 30210, 233, 143, 148, 233, 139, 155, 30392, 231, 190, 131, 31882, 30882, 13, 20841, 29901, 29871, 30672, 31381, 31424, 30505, 30878, 30257, 30210, 233, 143, 148, 233, 139, 155, 30392, 31522, 30698, 235, 177, 172, 30672, 30210, 30539, 30931, 30210, 31679, 234, 174, 161, 233, 187, 187, 233, 139, 146, 31100, 30666, 30606, 235, 164, 164, 30214, 235, 177, 172, 31951, 30502, 30313, 30769, 30815, 231, 189, 174, 232, 146, 154, 30780, 233, 187, 187, 233, 139, 146, 30210, 232, 194, 174, 31616, 30214, 31325, 30413, 30392, 31557, 30417, 31356, 31959, 30528, 30880, 30267, 13, 29909, 1357, 29901, 29871, 30810, 31835, 31195, 30392, 232, 193, 139, 30908, 30698, 30210, 30267, 30672, 233, 158, 193, 31412, 30505, 30287, 31959, 31419, 235, 184, 158, 30275, 236, 132, 138, 30780, 30743, 232, 193, 139, 232, 191, 189, 30210, 30783, 30880, 30214, 233, 135, 162, 235, 170, 140, 233, 187, 187, 233, 139, 146, 31369, 31475, 30743, 30287, 31959, 30606, 235, 164, 164, 30214, 30810, 232, 193, 139, 30413, 30539, 30606, 30267, 31658, 31596, 30392, 30214, 30919, 31381, 30847, 31502, 31548, 30687, 30810, 30502, 31658, 31596, 232, 148, 165, 30882, 13, 20841, 29901, 29871, 30672, 31381, 30724, 30505, 31026, 30910, 30287, 232, 168, 154, 30374, 30210, 233, 145, 149, 30548, 31185, 31675, 30214, 30998, 31393, 30763, 31951, 30502, 234, 145, 172, 30613, 30210, 31195, 236, 156, 136, 31615, 30815, 235, 178, 135, 30495, 30214, 31594, 31325, 30606, 235, 164, 164, 31951, 30502, 30313, 30210, 234, 145, 172, 30545, 30988, 236, 173, 143, 30267, 13, 29909, 1357, 29901, 29871, 31356, 232, 147, 175, 31558, 30805, 232, 193, 139, 31076, 30267, 31841, 31839, 30672, 30682, 30651, 30494, 30573, 30622, 30287, 30502, 31787, 234, 145, 172, 30810, 30502, 31185, 31675, 30210, 30313, 30267, 235, 179, 165, 235, 179, 165, 30919, 30210, 30594, 31016, 30214, 20841, 30267, 13, 32000]
labels:

Amy: 你好，Ben，我是Amy，一名电竞游戏选手，很高兴认识你。
Ben: 很高兴见到你，Amy。听说你在电竞比赛中表现出色，获得了很多奖杯。
Amy: 是的，我已经参加了很多比赛，但是我认为游戏还有很大的提升空间。你对电竞游戏的发展有什么看法呢？
Ben: 我认为电竞游戏的未来非常光明。我们的公司正在开发一款非常有潜力的电竞游戏，如果你有兴趣的话，可以来我们公司试玩一下。
Amy: 非常感谢你的邀请，我一定会去试一试。不过在比赛中我发现，电竞选手之间的沟通非常重要，你公司的游戏中是否有一些交流的机制呢？
Ben: 当然。我们的游戏中有三种不同的沟通方式。选手可以通过内置的语音聊天通道、文字聊天或者简单的表情符号来交流。
Amy: 那听起来很有趣。请问你公司目前最大的挑战是什么？
Ben: 我们现在最大的挑战是想要让我的公司的电竞游戏更加平衡，让每个人都能享受到游戏的快乐，而不是只有那些高手。
Amy: 这确实是很重要的。我曾经在一些比赛中遇到了很强的对手，感觉游戏失去了一些平衡，这很不公平。问题是，你们如何处理这个问题呢？
Ben: 我们正在开发一套新的排名系统，将根据每个玩家的实际技能评定，从而平衡每个人的玩法体验。
Amy: 那听起来很好。希望我可以成为第一个试玩这个系统的人。谢谢你的时间，Ben。
<|end|>
